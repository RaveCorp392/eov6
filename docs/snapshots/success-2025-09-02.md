# EOV6 — Success Snapshot (2025-09-02)

## What works (current live behavior)
- ✅ **Builds green** on Vercel.
- ✅ **Chat** sends/receives text on caller + agent.
- ✅ **Chat bubbles** with clean left/right alignment.
- ✅ **Autoscroll** to latest message.
- ✅ **Shift+Enter** inserts newline; **Enter** sends.
- ✅ **Caller details** form saves (name/phone/email/language) to Firestore.
- ✅ **File upload** writes to Firebase Storage (download URL available).
- ✅ Route structure in place:
  - Caller: /s/[code]
  - Agent: /agent/s/[code]

## Known gaps (observed)
- 🟡 **File messages not displayed in chat** yet (upload succeeds, but no visible bubble/link).
- 🟡 **Focus**: after sending or on page load, focus can jump away from the composer.
- 🟡 **Details prefill**: saved details don’t populate the form or a header above chat yet.
- 🟡 **Attach file** button styling: too wide on caller page (wants right-aligned, small button).
- 🟡 **Layout polish**: agent wants read-only “place card” for Name/Phone/Email/Language **above** chat; **Notes** centered **below** chat.

## Data model (as used today)
- **Text message** (collection): sessions/{code}/messages/{msgId}
  { "text": "...", "sender": "AGENT|CALLER", "ts": <number> }
- **Caller details** (doc): sessions/{code}/details/profile
  { "name": "", "phone": "", "email": "", "language": "", "notes": "" }
- **Uploads**: gs://.../uploads/{code}/{timestamp}-{filename}

## Rules (dev)
- Firestore rules temporarily loosened for /sessions/* to speed iteration.

## Decisions & UX notes
- **Notes persistence**: persists until explicit session cleanup.
- **One-third width**: chat ~33% on desktop.

## Next steps
1) Show file msgs; 2) Composer focus; 3) Agent details header; 4) Notes below chat; 5) Caller UI polish.

## Smoke tests
- Two tabs (caller/agent), send text, save details, upload file; verify in Firestore + Storage.
